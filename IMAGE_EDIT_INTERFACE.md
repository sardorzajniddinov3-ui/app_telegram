# 🖼️ Улучшенный интерфейс редактирования изображений

## ✅ Что улучшено

### 1. Быстрая замена изображений
- **Раньше:** Нужно было сначала удалить изображение, затем выбрать новое
- **Теперь:** Можно сразу заменить изображение одной кнопкой "🔄 Заменить изображение"

### 2. Улучшенный предпросмотр
- Используется функция `resolveImage` для правильного отображения всех форматов:
  - Base64 изображения (старый формат)
  - Полные URL (из Supabase Storage)
  - Пути к файлам (новый формат)
- Автоматическая обработка ошибок загрузки изображений

### 3. Удобный интерфейс
- Две кнопки рядом: "Заменить" и "Удалить"
- Предпросмотр изображения с рамкой
- Адаптивный дизайн для мобильных устройств

## 🎨 Интерфейс

### Когда есть изображение:
```
┌─────────────────────────────────┐
│  [Предпросмотр изображения]    │
│                                 │
│  ┌──────────┐  ┌──────────┐    │
│  │ 🔄 Заменить│  │ ✕ Удалить │    │
│  └──────────┘  └──────────┘    │
└─────────────────────────────────┘
```

### Когда нет изображения:
```
┌─────────────────────────────────┐
│  📷 Выбрать изображение из      │
│     галереи                     │
└─────────────────────────────────┘
```

## 🔧 Как использовать

### Заменить изображение:
1. Нажмите кнопку **"🔄 Заменить изображение"**
2. Выберите новое изображение из галереи
3. Предпросмотр обновится автоматически
4. Нажмите **"Сохранить изменения"**

### Удалить изображение:
1. Нажмите кнопку **"✕ Удалить"**
2. Изображение будет удалено из формы
3. Нажмите **"Сохранить изменения"**

### Добавить изображение:
1. Нажмите **"📷 Выбрать изображение из галереи"**
2. Выберите изображение
3. Предпросмотр появится автоматически
4. Нажмите **"Добавить вопрос"** или **"Сохранить изменения"**

## ⚙️ Технические детали

### Обработка изображений:
- При замене изображения старое blob URL автоматически освобождается
- Старое изображение из Storage удаляется при сохранении
- Новое изображение загружается в Storage с оптимизацией (WebP, сжатие)

### Поддерживаемые форматы:
- **Base64:** `data:image/png;base64,...` (старый формат)
- **Полный URL:** `https://...supabase.co/storage/v1/object/public/...`
- **Путь к файлу:** `questions/123.webp` (новый формат)

### Ограничения:
- Максимальный размер файла: 10MB (до оптимизации)
- Поддерживаемые форматы: все изображения (`image/*`)
- Автоматическая оптимизация: WebP, сжатие до 1200px

## 🎨 Стили

### Светлая тема:
- Кнопка "Заменить": синяя (#2196F3)
- Кнопка "Удалить": красная (#f44336)
- Предпросмотр: белая рамка, серый фон

### Темная тема:
- Кнопки адаптированы под темную тему
- Предпросмотр: темная рамка, темный фон

## 📝 Примечания

- Изображения автоматически оптимизируются при загрузке
- Старые изображения удаляются из Storage при замене
- Предпросмотр работает для всех форматов изображений
- Ошибки загрузки обрабатываются автоматически
